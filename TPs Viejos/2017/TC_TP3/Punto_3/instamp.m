R1 = 200;
R2= 10000;
R3 = 2400;
R4 = 1500;
R5 = 1000;
R6 = 1500;
R7 = 2400;
R8 = 1000;
R9 = 1000;
r1 = 200;
r2= 10000;
r3 = 2400;
r4 = 1500;
r5 = 2000;
r6 = 1500;
r7 = 2400;
r8 = 0;
r9 = 0;
syms aplha beta gamma theta phi lambda upsilon epsilon zeta eta
alpha = R3*R5+R3*R6+R3*R7+R4*R5+R4*R6+R5*R6+R5*R7;
beta = R3*R5+R3*R6+R4*R5+R4*R6+R5*R6;
gamma = R3*R7+R4*R7;
theta = R3*R5;
phi = R3*R6+R3*R7;
lambda = R4*R5+R4*R6+R4*R7+R5*R6+R5*R7;
upsilon = R5*R7;
epsilon = R3*R5+R3*R6+2*R4*R5+2*R4*R6+R4*R7+2*R5*R6+R5*R7;
zeta = R3*R7+R4*R5+R4*R6+R4*R7+R5*R6;
eta = R4*R7;
A0 = 200000;
a0 = A0;
wp = 15*2*pi;
s = tf('s');
a = A0*wp/(s+wp);
Gd=(-R2/(R1))*(R1*a/(R1*a+R2))*((a0^3*wp^3*(gamma + phi) + 2*a0*alpha*wp*(s + wp)^2 + a0^2*wp^2*(s + wp)*(beta + lambda + theta + upsilon))/(2*(alpha*(s + wp)^3 + a0^3*eta*wp^3 + a0*epsilon*wp*(s + wp)^2 + a0^2*wp^2*zeta*(s + wp))));
Gd2=(-R2/(R1))*(R1*a/(R1*a+R2))*(a*(2*R3*R7+R4*R7+R3*R6))/(2*R7*(R3+R4+a*R4));
[md pd wd] = bode(Gd);
md = 20*log10(md(:));
fd = wd/(2*pi);
pd = pd(:);
[md2 pd2 wd2] = bode(Gd2);
md2 = 20*log10(md2(:));
fd2 = wd2/(2*pi);
pd2 = pd2(:);
datasimgc = LTspiceBoldeSimulationLoader('bode_comun.txt');
datasimgd = LTspiceBoldeSimulationLoader('bode_diferencial.txt');
measdatad = load('bodediferencial.csv');
measdatac = load('bodecomun.csv');